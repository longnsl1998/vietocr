Create train_hw:   0%|                                                     | 0/6099 [00:00<?, ?it/s]Create train_hw:   5%|██▏                                      | 324/6099 [00:00<00:01, 3235.64it/s]Create train_hw:  11%|████▍                                    | 657/6099 [00:00<00:01, 3290.18it/s]Create train_hw:  16%|██████▋                                  | 987/6099 [00:00<00:01, 3246.66it/s]Create train_hw:  22%|████████▌                               | 1312/6099 [00:00<00:01, 2862.16it/s]Create train_hw:  26%|██████████▌                             | 1612/6099 [00:00<00:01, 2907.24it/s]Create train_hw:  32%|████████████▋                           | 1930/6099 [00:00<00:01, 2993.30it/s]Create train_hw:  37%|██████████████▋                         | 2233/6099 [00:00<00:01, 2807.82it/s]Create train_hw:  42%|████████████████▋                       | 2552/6099 [00:00<00:01, 2917.84it/s]Create train_hw:  47%|██████████████████▊                     | 2859/6099 [00:00<00:01, 2961.04it/s]Create train_hw:  52%|████████████████████▋                   | 3158/6099 [00:01<00:01, 2807.92it/s]Create train_hw:  57%|██████████████████████▊                 | 3481/6099 [00:01<00:00, 2928.43it/s]Create train_hw:  62%|████████████████████████▉               | 3795/6099 [00:01<00:00, 2986.23it/s]Create train_hw:  67%|██████████████████████████▊             | 4096/6099 [00:01<00:00, 2703.36it/s]Create train_hw:  72%|████████████████████████████▋           | 4373/6099 [00:01<00:00, 2708.36it/s]Create train_hw:  76%|██████████████████████████████▍         | 4649/6099 [00:01<00:00, 2662.64it/s]Create train_hw:  81%|████████████████████████████████▌       | 4956/6099 [00:01<00:00, 2776.89it/s]Create train_hw:  86%|██████████████████████████████████▎     | 5237/6099 [00:01<00:00, 2568.93it/s]Create train_hw:  91%|████████████████████████████████████▎   | 5537/6099 [00:01<00:00, 2686.64it/s]Create train_hw:  96%|██████████████████████████████████████▍ | 5852/6099 [00:02<00:00, 2812.94it/s]Create train_hw: 100%|████████████████████████████████████████| 6099/6099 [00:02<00:00, 2805.25it/s]{'vocab': 'aAàÀảẢãÃáÁạẠăĂằẰẳẲẵẴắẮặẶâÂầẦẩẨẫẪấẤậẬbBcCdDđĐeEèÈẻẺẽẼéÉẹẸêÊềỀểỂễỄếẾệỆfFgGhHiIìÌỉỈĩĨíÍịỊjJkKlLmMnNoOòÒỏỎõÕóÓọỌôÔồỒổỔỗỖốỐộỘơƠờỜởỞỡỠớỚợỢpPqQrRsStTuUùÙủỦũŨúÚụỤưƯừỪửỬữỮứỨựỰvVwWxXyYỳỲỷỶỹỸýÝỵỴzZ0123456789!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~ ', 'device': 'cuda', 'seq_modeling': 'seq2seq', 'transformer': {'encoder_hidden': 256, 'decoder_hidden': 256, 'img_channel': 256, 'decoder_embedded': 256, 'dropout': 0.1}, 'optimizer': {'max_lr': 0.001, 'pct_start': 0.1}, 'trainer': {'batch_size': 32, 'print_every': 200, 'valid_every': 2000, 'iters': 100000, 'export': './train_config/seq2seq_2306_pretrain_32_7k.pth', 'checkpoint': './checkpoint/seq2seq_2306_pretrain_32_7k.pth', 'log': './train.log', 'metrics': 15000}, 'dataset': {'name': 'hw', 'data_root': '/home/longhn', 'train_annotation': '/home/longhn/Annotation_2306/train.txt', 'valid_annotation': '/home/longhn/Annotation_2306/valid.txt', 'image_height': 32, 'image_min_width': 32, 'image_max_width': 512}, 'dataloader': {'num_workers': 1, 'pin_memory': True}, 'aug': {'image_aug': True, 'masked_language_model': True}, 'predictor': {'beamsearch': False}, 'quiet': False, 'pretrain': {'id_or_url': '1nTKlEog9YFK74kPyX0qLwCWi60_YHHk4', 'md5': 'efcabaa6d3adfca8e52bda2fd7d2ee04', 'cached': '/tmp/tranformerorc.pth'}, 'weights': 'https://drive.google.com/uc?id=1nTKlEog9YFK74kPyX0qLwCWi60_YHHk4', 'backbone': 'vgg19_bn', 'cnn': {'ss': [[2, 2], [2, 2], [2, 1], [2, 1], [1, 1]], 'ks': [[2, 2], [2, 2], [2, 1], [2, 1], [1, 1]], 'hidden': 256}}
Computing MD5: /tmp/tranformerorc.pth
MD5 matches: /tmp/tranformerorc.pth
createDataset
Done

train_hw build cluster:   0%|                                              | 0/6098 [00:00<?, ?it/s]train_hw build cluster: 100%|███████████████████████████████| 6098/6098 [00:00<00:00, 200055.27it/s]
Create valid_hw:   0%|                                                      | 0/640 [00:00<?, ?it/s]Create valid_hw:  49%|████████████████████▋                     | 316/640 [00:00<00:00, 3153.46it/s]Create valid_hw:  99%|█████████████████████████████████████████▍| 632/640 [00:00<00:00, 2974.09it/s]Create valid_hw: 100%|██████████████████████████████████████████| 640/640 [00:00<00:00, 3009.77it/s]b'6098'
createDataset
Done

valid_hw build cluster:   0%|                                               | 0/639 [00:00<?, ?it/s]valid_hw build cluster: 100%|█████████████████████████████████| 639/639 [00:00<00:00, 168499.95it/s]b'639'

iter: 000200 - train loss: 0.665 - lr: 4.09e-05 - load time: 0.97 - gpu time: 64.85
iter: 000400 - train loss: 0.640 - lr: 4.38e-05 - load time: 0.73 - gpu time: 64.28
iter: 000600 - train loss: 0.635 - lr: 4.85e-05 - load time: 0.74 - gpu time: 66.23
iter: 000800 - train loss: 0.619 - lr: 5.51e-05 - load time: 0.55 - gpu time: 64.18
iter: 001000 - train loss: 0.624 - lr: 6.35e-05 - load time: 1.01 - gpu time: 66.34
iter: 001200 - train loss: 0.618 - lr: 7.37e-05 - load time: 0.52 - gpu time: 63.10
iter: 001400 - train loss: 0.625 - lr: 8.57e-05 - load time: 0.80 - gpu time: 67.87
iter: 001600 - train loss: 0.609 - lr: 9.94e-05 - load time: 0.57 - gpu time: 64.70
iter: 001800 - train loss: 0.610 - lr: 1.15e-04 - load time: 0.68 - gpu time: 63.76
iter: 002000 - train loss: 0.609 - lr: 1.32e-04 - load time: 0.77 - gpu time: 63.94
iter: 002000 - valid loss: 0.622 - acc full seq: 0.7188 - acc per char: 0.9551
iter: 002200 - train loss: 0.599 - lr: 1.50e-04 - load time: 0.94 - gpu time: 63.40
iter: 002400 - train loss: 0.603 - lr: 1.70e-04 - load time: 0.71 - gpu time: 66.70
iter: 002600 - train loss: 0.596 - lr: 1.91e-04 - load time: 0.81 - gpu time: 65.55
iter: 002800 - train loss: 0.598 - lr: 2.14e-04 - load time: 0.64 - gpu time: 65.75
iter: 003000 - train loss: 0.600 - lr: 2.38e-04 - load time: 1.11 - gpu time: 64.20
iter: 003200 - train loss: 0.607 - lr: 2.63e-04 - load time: 0.65 - gpu time: 67.42
iter: 003400 - train loss: 0.590 - lr: 2.89e-04 - load time: 0.74 - gpu time: 62.22
iter: 003600 - train loss: 0.599 - lr: 3.16e-04 - load time: 0.71 - gpu time: 67.09
iter: 003800 - train loss: 0.595 - lr: 3.43e-04 - load time: 0.76 - gpu time: 64.59
iter: 004000 - train loss: 0.599 - lr: 3.72e-04 - load time: 0.94 - gpu time: 64.32
iter: 004000 - valid loss: 0.622 - acc full seq: 0.7902 - acc per char: 0.9586
iter: 004200 - train loss: 0.589 - lr: 4.01e-04 - load time: 0.53 - gpu time: 64.26
iter: 004400 - train loss: 0.589 - lr: 4.30e-04 - load time: 0.60 - gpu time: 65.19
iter: 004600 - train loss: 0.596 - lr: 4.60e-04 - load time: 0.55 - gpu time: 65.67
iter: 004800 - train loss: 0.596 - lr: 4.90e-04 - load time: 0.82 - gpu time: 64.12
iter: 005000 - train loss: 0.595 - lr: 5.20e-04 - load time: 0.49 - gpu time: 65.15
iter: 005200 - train loss: 0.597 - lr: 5.50e-04 - load time: 0.74 - gpu time: 65.39
iter: 005400 - train loss: 0.575 - lr: 5.80e-04 - load time: 0.58 - gpu time: 63.03
iter: 005600 - train loss: 0.595 - lr: 6.10e-04 - load time: 0.48 - gpu time: 65.85
iter: 005800 - train loss: 0.593 - lr: 6.39e-04 - load time: 0.83 - gpu time: 64.72
iter: 006000 - train loss: 0.594 - lr: 6.68e-04 - load time: 0.54 - gpu time: 65.10
iter: 006000 - valid loss: 0.619 - acc full seq: 0.7991 - acc per char: 0.9595
iter: 006200 - train loss: 0.582 - lr: 6.97e-04 - load time: 0.26 - gpu time: 63.24
iter: 006400 - train loss: 0.590 - lr: 7.24e-04 - load time: 0.69 - gpu time: 66.38
iter: 006600 - train loss: 0.594 - lr: 7.51e-04 - load time: 0.85 - gpu time: 63.78
iter: 006800 - train loss: 0.594 - lr: 7.77e-04 - load time: 0.82 - gpu time: 65.01
iter: 007000 - train loss: 0.591 - lr: 8.02e-04 - load time: 0.64 - gpu time: 65.06
iter: 007200 - train loss: 0.589 - lr: 8.26e-04 - load time: 0.55 - gpu time: 64.27
iter: 007400 - train loss: 0.590 - lr: 8.49e-04 - load time: 0.61 - gpu time: 66.51
iter: 007600 - train loss: 0.588 - lr: 8.70e-04 - load time: 0.86 - gpu time: 62.79
iter: 007800 - train loss: 0.592 - lr: 8.90e-04 - load time: 0.57 - gpu time: 65.99
iter: 008000 - train loss: 0.585 - lr: 9.08e-04 - load time: 0.75 - gpu time: 64.50
iter: 008000 - valid loss: 0.639 - acc full seq: 0.6696 - acc per char: 0.9589
iter: 008200 - train loss: 0.599 - lr: 9.25e-04 - load time: 0.82 - gpu time: 62.42
iter: 008400 - train loss: 0.600 - lr: 9.41e-04 - load time: 0.45 - gpu time: 66.91
iter: 008600 - train loss: 0.596 - lr: 9.54e-04 - load time: 0.78 - gpu time: 64.76
iter: 008800 - train loss: 0.584 - lr: 9.66e-04 - load time: 0.99 - gpu time: 63.29
iter: 009000 - train loss: 0.597 - lr: 9.77e-04 - load time: 0.60 - gpu time: 65.63
iter: 009200 - train loss: 0.594 - lr: 9.85e-04 - load time: 0.81 - gpu time: 63.09
iter: 009400 - train loss: 0.593 - lr: 9.92e-04 - load time: 0.41 - gpu time: 64.78
iter: 009600 - train loss: 0.592 - lr: 9.96e-04 - load time: 1.00 - gpu time: 66.22
iter: 009800 - train loss: 0.596 - lr: 9.99e-04 - load time: 0.49 - gpu time: 65.14
iter: 010000 - train loss: 0.591 - lr: 1.00e-03 - load time: 0.57 - gpu time: 64.70
iter: 010000 - valid loss: 0.630 - acc full seq: 0.6741 - acc per char: 0.9220
iter: 010200 - train loss: 0.585 - lr: 1.00e-03 - load time: 0.63 - gpu time: 62.76
iter: 010400 - train loss: 0.591 - lr: 1.00e-03 - load time: 1.24 - gpu time: 65.42
iter: 010600 - train loss: 0.588 - lr: 1.00e-03 - load time: 0.69 - gpu time: 62.75
iter: 010800 - train loss: 0.592 - lr: 1.00e-03 - load time: 0.50 - gpu time: 67.35
iter: 011000 - train loss: 0.593 - lr: 1.00e-03 - load time: 0.74 - gpu time: 63.61
iter: 011200 - train loss: 0.586 - lr: 1.00e-03 - load time: 0.92 - gpu time: 63.42
iter: 011400 - train loss: 0.594 - lr: 9.99e-04 - load time: 0.73 - gpu time: 65.95
iter: 011600 - train loss: 0.585 - lr: 9.99e-04 - load time: 0.42 - gpu time: 62.64
iter: 011800 - train loss: 0.587 - lr: 9.99e-04 - load time: 0.47 - gpu time: 64.94
iter: 012000 - train loss: 0.588 - lr: 9.99e-04 - load time: 0.69 - gpu time: 64.83
iter: 012000 - valid loss: 0.632 - acc full seq: 0.7277 - acc per char: 0.9437
iter: 012200 - train loss: 0.585 - lr: 9.99e-04 - load time: 0.56 - gpu time: 66.37
iter: 012400 - train loss: 0.586 - lr: 9.98e-04 - load time: 0.99 - gpu time: 61.86
iter: 012600 - train loss: 0.597 - lr: 9.98e-04 - load time: 0.56 - gpu time: 66.96
iter: 012800 - train loss: 0.580 - lr: 9.98e-04 - load time: 1.07 - gpu time: 62.59
iter: 013000 - train loss: 0.597 - lr: 9.97e-04 - load time: 0.52 - gpu time: 66.10
iter: 013200 - train loss: 0.584 - lr: 9.97e-04 - load time: 0.73 - gpu time: 63.78
iter: 013400 - train loss: 0.583 - lr: 9.96e-04 - load time: 0.80 - gpu time: 62.95
iter: 013600 - train loss: 0.589 - lr: 9.96e-04 - load time: 0.41 - gpu time: 67.43
iter: 013800 - train loss: 0.580 - lr: 9.96e-04 - load time: 0.41 - gpu time: 64.20
iter: 014000 - train loss: 0.581 - lr: 9.95e-04 - load time: 0.69 - gpu time: 63.51
iter: 014000 - valid loss: 0.624 - acc full seq: 0.7589 - acc per char: 0.9600
iter: 014200 - train loss: 0.586 - lr: 9.95e-04 - load time: 0.87 - gpu time: 65.11
iter: 014400 - train loss: 0.576 - lr: 9.94e-04 - load time: 0.54 - gpu time: 64.55
iter: 014600 - train loss: 0.586 - lr: 9.94e-04 - load time: 0.54 - gpu time: 64.33
iter: 014800 - train loss: 0.581 - lr: 9.93e-04 - load time: 0.58 - gpu time: 66.07
iter: 015000 - train loss: 0.582 - lr: 9.92e-04 - load time: 0.52 - gpu time: 63.68
iter: 015200 - train loss: 0.577 - lr: 9.92e-04 - load time: 0.83 - gpu time: 64.65
iter: 015400 - train loss: 0.578 - lr: 9.91e-04 - load time: 0.64 - gpu time: 64.40
iter: 015600 - train loss: 0.584 - lr: 9.90e-04 - load time: 0.59 - gpu time: 64.93
iter: 015800 - train loss: 0.574 - lr: 9.90e-04 - load time: 0.63 - gpu time: 65.01
iter: 016000 - train loss: 0.585 - lr: 9.89e-04 - load time: 0.50 - gpu time: 65.53
iter: 016000 - valid loss: 0.620 - acc full seq: 0.7634 - acc per char: 0.9502
iter: 016200 - train loss: 0.577 - lr: 9.88e-04 - load time: 0.94 - gpu time: 63.84
iter: 016400 - train loss: 0.589 - lr: 9.88e-04 - load time: 0.57 - gpu time: 66.51
iter: 016600 - train loss: 0.580 - lr: 9.87e-04 - load time: 0.60 - gpu time: 65.12
iter: 016800 - train loss: 0.582 - lr: 9.86e-04 - load time: 0.44 - gpu time: 62.63
iter: 017000 - train loss: 0.581 - lr: 9.85e-04 - load time: 1.21 - gpu time: 65.51
iter: 017200 - train loss: 0.577 - lr: 9.84e-04 - load time: 0.74 - gpu time: 64.96
iter: 017400 - train loss: 0.576 - lr: 9.83e-04 - load time: 0.66 - gpu time: 65.35
iter: 017600 - train loss: 0.582 - lr: 9.83e-04 - load time: 0.61 - gpu time: 63.48
iter: 017800 - train loss: 0.586 - lr: 9.82e-04 - load time: 0.74 - gpu time: 65.23
iter: 018000 - train loss: 0.575 - lr: 9.81e-04 - load time: 1.02 - gpu time: 64.11
iter: 018000 - valid loss: 0.620 - acc full seq: 0.7411 - acc per char: 0.9401
iter: 018200 - train loss: 0.577 - lr: 9.80e-04 - load time: 0.37 - gpu time: 66.42
iter: 018400 - train loss: 0.581 - lr: 9.79e-04 - load time: 0.47 - gpu time: 65.23
iter: 018600 - train loss: 0.581 - lr: 9.78e-04 - load time: 0.51 - gpu time: 64.04
iter: 018800 - train loss: 0.580 - lr: 9.77e-04 - load time: 0.57 - gpu time: 63.59
iter: 019000 - train loss: 0.580 - lr: 9.76e-04 - load time: 0.97 - gpu time: 65.22
iter: 019200 - train loss: 0.572 - lr: 9.74e-04 - load time: 0.87 - gpu time: 64.95
iter: 019400 - train loss: 0.580 - lr: 9.73e-04 - load time: 0.55 - gpu time: 63.99
iter: 019600 - train loss: 0.573 - lr: 9.72e-04 - load time: 0.74 - gpu time: 63.56
iter: 019800 - train loss: 0.576 - lr: 9.71e-04 - load time: 0.72 - gpu time: 65.13
iter: 020000 - train loss: 0.579 - lr: 9.70e-04 - load time: 0.78 - gpu time: 65.34
iter: 020000 - valid loss: 0.622 - acc full seq: 0.7545 - acc per char: 0.9400
iter: 020200 - train loss: 0.570 - lr: 9.69e-04 - load time: 0.58 - gpu time: 63.54
iter: 020400 - train loss: 0.578 - lr: 9.67e-04 - load time: 0.39 - gpu time: 65.73
iter: 020600 - train loss: 0.568 - lr: 9.66e-04 - load time: 0.91 - gpu time: 63.16
iter: 020800 - train loss: 0.579 - lr: 9.65e-04 - load time: 0.84 - gpu time: 65.19
iter: 021000 - train loss: 0.572 - lr: 9.64e-04 - load time: 0.57 - gpu time: 65.22
iter: 021200 - train loss: 0.580 - lr: 9.62e-04 - load time: 0.60 - gpu time: 66.48
iter: 021400 - train loss: 0.574 - lr: 9.61e-04 - load time: 0.55 - gpu time: 62.37
iter: 021600 - train loss: 0.574 - lr: 9.60e-04 - load time: 0.50 - gpu time: 65.98
iter: 021800 - train loss: 0.579 - lr: 9.58e-04 - load time: 0.69 - gpu time: 64.29
iter: 022000 - train loss: 0.582 - lr: 9.57e-04 - load time: 0.34 - gpu time: 66.72
iter: 022000 - valid loss: 0.614 - acc full seq: 0.7321 - acc per char: 0.9462
iter: 022200 - train loss: 0.574 - lr: 9.55e-04 - load time: 0.65 - gpu time: 62.46
iter: 022400 - train loss: 0.577 - lr: 9.54e-04 - load time: 0.42 - gpu time: 66.13
iter: 022600 - train loss: 0.572 - lr: 9.52e-04 - load time: 0.59 - gpu time: 63.19
iter: 022800 - train loss: 0.576 - lr: 9.51e-04 - load time: 0.74 - gpu time: 66.13
iter: 023000 - train loss: 0.570 - lr: 9.49e-04 - load time: 0.57 - gpu time: 63.89
iter: 023200 - train loss: 0.575 - lr: 9.48e-04 - load time: 0.69 - gpu time: 65.08
iter: 023400 - train loss: 0.574 - lr: 9.46e-04 - load time: 0.38 - gpu time: 63.86
iter: 023600 - train loss: 0.577 - lr: 9.45e-04 - load time: 0.57 - gpu time: 66.00
iter: 023800 - train loss: 0.579 - lr: 9.43e-04 - load time: 0.57 - gpu time: 66.29
iter: 024000 - train loss: 0.573 - lr: 9.41e-04 - load time: 0.59 - gpu time: 63.36
iter: 024000 - valid loss: 0.617 - acc full seq: 0.7545 - acc per char: 0.9431
iter: 024200 - train loss: 0.580 - lr: 9.40e-04 - load time: 0.56 - gpu time: 64.86
iter: 024400 - train loss: 0.571 - lr: 9.38e-04 - load time: 0.67 - gpu time: 64.58
iter: 024600 - train loss: 0.572 - lr: 9.36e-04 - load time: 0.92 - gpu time: 64.31
iter: 024800 - train loss: 0.581 - lr: 9.35e-04 - load time: 0.73 - gpu time: 64.86
iter: 025000 - train loss: 0.572 - lr: 9.33e-04 - load time: 0.72 - gpu time: 64.87
iter: 025200 - train loss: 0.571 - lr: 9.31e-04 - load time: 0.62 - gpu time: 64.08
iter: 025400 - train loss: 0.573 - lr: 9.29e-04 - load time: 0.52 - gpu time: 64.33
iter: 025600 - train loss: 0.574 - lr: 9.28e-04 - load time: 0.87 - gpu time: 64.78
iter: 025800 - train loss: 0.575 - lr: 9.26e-04 - load time: 0.78 - gpu time: 64.38
iter: 026000 - train loss: 0.566 - lr: 9.24e-04 - load time: 0.68 - gpu time: 64.67
iter: 026000 - valid loss: 0.633 - acc full seq: 0.6607 - acc per char: 0.9234
iter: 026200 - train loss: 0.576 - lr: 9.22e-04 - load time: 0.46 - gpu time: 65.53
iter: 026400 - train loss: 0.571 - lr: 9.20e-04 - load time: 0.46 - gpu time: 66.17
iter: 026600 - train loss: 0.572 - lr: 9.18e-04 - load time: 0.83 - gpu time: 64.30
iter: 026800 - train loss: 0.575 - lr: 9.16e-04 - load time: 0.55 - gpu time: 65.38
iter: 027000 - train loss: 0.571 - lr: 9.15e-04 - load time: 0.45 - gpu time: 65.20
iter: 027200 - train loss: 0.575 - lr: 9.13e-04 - load time: 0.88 - gpu time: 64.89
iter: 027400 - train loss: 0.571 - lr: 9.11e-04 - load time: 0.73 - gpu time: 64.69
iter: 027600 - train loss: 0.576 - lr: 9.09e-04 - load time: 0.49 - gpu time: 67.05
iter: 027800 - train loss: 0.574 - lr: 9.07e-04 - load time: 0.52 - gpu time: 62.04
iter: 028000 - train loss: 0.565 - lr: 9.04e-04 - load time: 0.49 - gpu time: 64.87
iter: 028000 - valid loss: 0.670 - acc full seq: 0.5536 - acc per char: 0.8414
iter: 028200 - train loss: 0.573 - lr: 9.02e-04 - load time: 0.54 - gpu time: 66.24
iter: 028400 - train loss: 0.573 - lr: 9.00e-04 - load time: 0.85 - gpu time: 65.02
iter: 028600 - train loss: 0.570 - lr: 8.98e-04 - load time: 0.61 - gpu time: 66.29
iter: 028800 - train loss: 0.575 - lr: 8.96e-04 - load time: 0.31 - gpu time: 64.03
iter: 029000 - train loss: 0.565 - lr: 8.94e-04 - load time: 0.67 - gpu time: 61.26
iter: 029200 - train loss: 0.579 - lr: 8.92e-04 - load time: 0.50 - gpu time: 67.94
